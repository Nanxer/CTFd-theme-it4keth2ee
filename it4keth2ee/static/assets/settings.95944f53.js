import{m as d,C as h}from"./index.8bd281d2.js";import{s as u,c as f}from"./clipboard.59b0cc48.js";window.Alpine=d;d.data("SettingsForm",()=>({success:null,error:null,initial:null,errors:[],init(){this.initial=u(this.$el)},async updateProfile(){this.success=null,this.error=null,this.errors=[];let e=u(this.$el,this.initial,!0);e.fields=[];for(const o in e)if(o.match(/fields\[\d+\]/)){let l={},s=parseInt(o.slice(7,-1));l.field_id=s,l.value=e[o],e.fields.push(l),delete e[o]}const t=await h.pages.settings.updateSettings(e);t.success?(this.success=!0,this.error=!1,setTimeout(()=>{this.success=null,this.error=null},3e3)):(this.success=!1,this.error=!0,Object.keys(t.errors).map(o=>{const l=t.errors[o];this.errors.push(l)}))}}));d.data("TokensForm",()=>({token:null,async generateToken(){const e=u(this.$el);e.expiration||delete e.expiration;const t=await h.pages.settings.generateToken(e);this.token=t.data.value;const o=this.$refs.tokenModal;o.style.display="block",this.setupModalCloseHandlers(o)},copyToken(){f(this.$refs.token)},setupModalCloseHandlers(e){const t=s=>{s.target===e&&this.closeModal(e)};e.addEventListener("click",t);const o=s=>{s.key==="Escape"&&this.closeModal(e)};document.addEventListener("keydown",o);const l=e.querySelectorAll('[data-bs-dismiss="modal"], .btn-close, .close, button[aria-label*="close"], button[title*="close"]');l.forEach(s=>{var i,c,r,a;s.removeAttribute("data-bs-dismiss"),(s.classList.contains("btn-close")||s.classList.contains("close")||((i=s.getAttribute("aria-label"))==null?void 0:i.toLowerCase().includes("close"))||((c=s.getAttribute("title"))==null?void 0:c.toLowerCase().includes("close"))||((r=s.textContent)==null?void 0:r.trim().toLowerCase())==="\xD7"||((a=s.textContent)==null?void 0:a.trim().toLowerCase())==="close")&&s.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),this.closeModal(e)})}),e._closeHandlers={modalClick:t,escKey:o,closeButtons:l}},closeModal(e){e.style.display="none",e._closeHandlers&&(e.removeEventListener("click",e._closeHandlers.modalClick),document.removeEventListener("keydown",e._closeHandlers.escKey),e._closeHandlers.closeButtons.forEach(t=>{t.removeEventListener("click",this.closeModal)}),delete e._closeHandlers)}}));d.data("Tokens",()=>({selectedTokenId:null,async deleteTokenModal(e){this.selectedTokenId=e;const t=this.$refs.confirmModal;t.style.display="block",this.setupModalCloseHandlers(t)},async deleteSelectedToken(){await h.pages.settings.deleteToken(this.selectedTokenId);const e=this.$refs[`token-${this.selectedTokenId}`];e&&e.remove();const t=this.$refs.confirmModal;this.closeModal(t)},setupModalCloseHandlers(e){const t=s=>{s.target===e&&this.closeModal(e)};e.addEventListener("click",t);const o=s=>{s.key==="Escape"&&this.closeModal(e)};document.addEventListener("keydown",o);const l=e.querySelectorAll('[data-bs-dismiss="modal"], .btn-close, .close, button[aria-label*="close"], button[title*="close"]');l.forEach(s=>{var i,c,r,a;s.removeAttribute("data-bs-dismiss"),(s.classList.contains("btn-close")||s.classList.contains("close")||((i=s.getAttribute("aria-label"))==null?void 0:i.toLowerCase().includes("close"))||((c=s.getAttribute("title"))==null?void 0:c.toLowerCase().includes("close"))||((r=s.textContent)==null?void 0:r.trim().toLowerCase())==="\xD7"||((a=s.textContent)==null?void 0:a.trim().toLowerCase())==="close")&&s.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),this.closeModal(e)})}),e._closeHandlers={modalClick:t,escKey:o,closeButtons:l}},closeModal(e){e.style.display="none",e._closeHandlers&&(e.removeEventListener("click",e._closeHandlers.modalClick),document.removeEventListener("keydown",e._closeHandlers.escKey),e._closeHandlers.closeButtons.forEach(t=>{t.removeEventListener("click",this.closeModal)}),delete e._closeHandlers)}}));d.start();
